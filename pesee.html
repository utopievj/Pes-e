<!doctype html>
<html lang="fr">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Pes√©e</title>

<style>
body{margin:0;font-family:system-ui;background:#0b0c10;color:#e9eef6}
.wrap{max-width:900px;margin:auto;padding:18px}
.card{background:#12141b;border:1px solid #222634;border-radius:16px;padding:16px}
label{display:block;margin:10px 0 6px;font-size:12px;color:#a8b3d6}
input,select{width:100%;padding:12px;border-radius:12px;border:1px solid #262b3a;background:#0f1118;color:#fff}
button{width:100%;padding:12px;border-radius:12px;border:1px solid #7a1f1f;background:#b22222;color:#fff;font-weight:700}
button:hover{background:#d32f2f}
.big{font-size:34px;font-weight:900}
.net{margin-top:14px;padding:14px;border:1px solid #222634;border-radius:14px;background:#0f1118}
.grid{display:grid;gap:12px;grid-template-columns:repeat(12,1fr)}
.col-4{grid-column:span 4}
.col-2{grid-column:span 2}
.col-6{grid-column:span 6}
.col-12{grid-column:span 12}
@media(max-width:760px){.col-4,.col-2,.col-6{grid-column:span 12}}
table{width:100%;border-collapse:collapse;margin-top:10px}
th,td{padding:8px;border-bottom:1px solid #222634}
th{font-size:12px;color:#a8b3d6}
.small{width:auto;padding:6px 10px}
.danger{background:#8b0000}
</style>
</head>

<body>

<!-- üîê LOGIN -->
<div id="login" style="min-height:100vh;display:flex;align-items:center;justify-content:center">
<div class="card" style="max-width:360px;width:100%">
<h2 style="text-align:center">Connexion</h2>

<label>Identifiant</label>
<input id="user">

<label>Mot de passe</label>
<input id="pass" type="password">

<button onclick="login()">SE CONNECTER</button>
<div id="err" style="color:#ff5a6a;text-align:center;margin-top:10px;display:none">
Identifiant ou mot de passe incorrect
</div>
</div>
</div>

<!-- üßÆ APP -->
<div id="app" style="display:none">
<div class="wrap">
<div class="card">

<h2>Pes√©e</h2>

<div class="grid">
<div class="col-4">
<label>Ville</label>
<select id="ville">
<option>Boulanger Tarbes</option>
<option>Pau</option>
<option>Envie</option>
<option>Assat</option>
<option>Coaraze</option>
<option>Espoey</option>
</select>
</div>

<div class="col-4">
<label>Type de bac</label>
<select id="type">
<option value="PAM">PAM</option>
<option value="ASL">ASL</option>
<option value="ABJ">ABJ</option>
<option value="FRIGO">Frigo</option>
<option value="HF">Hors froid</option>
</select>
</div>

<div class="col-2">
<label>Nombre</label>
<select id="nb">
<option>1</option><option>2</option><option>3</option><option>4</option>
</select>
</div>

<div class="col-2">
<label>Poids brut (kg)</label>
<input id="brut" type="number" step="0.1" value="0">
</div>

<div class="col-12">
<div class="net">
<div>Tare : <b id="tare">0</b> kg</div>
<div class="big">Net : <span id="net">0</span> kg</div>
</div>
</div>

<div class="col-6"><button onclick="save()">ENREGISTRER</button></div>
<div class="col-6"><button onclick="reset()">R√âINITIALISER</button></div>
</div>

<h3>Historique</h3>
<button class="danger" onclick="clearAll()">VIDER</button>

<table>
<thead>
<tr><th>Date</th><th>Ville</th><th>Type</th><th>Nb</th><th>Net</th><th></th></tr>
</thead>
<tbody id="hist"></tbody>
</table>

</div>
</div>
</div>

<script>
/* üîê LOGIN */
const USER="pesee", PASS="1234";
function login(){
 if(user.value===USER && pass.value===PASS){
  loginDiv.style.display="none"; app.style.display="block";
 } else err.style.display="block";
}
const loginDiv=document.getElementById("login");
const app=document.getElementById("app");

/* üßÆ APP */
const T={PAM:59,ASL:45,ABJ:43,FRIGO:0,HF:0};
const A={PAM:"PAM",ASL:"ASL",ABJ:"ABJ",FRIGO:"F",HF:"HF"};
const KEY="pesee_hist";

function calc(){
 const t=T[type.value]*nb.value;
 tare.textContent=t;
 net.textContent=(brut.value-t).toFixed(1);
}
["change","input"].forEach(e=>{
 type.addEventListener(e,calc);
 nb.addEventListener(e,calc);
 brut.addEventListener(e,calc);
});

function save(){
 const d=JSON.parse(localStorage.getItem(KEY)||"[]");
 d.push({
  id:crypto.randomUUID(),
  date:new Date().toLocaleString(),
  ville:ville.value,
  type:A[type.value],
  nb:nb.value,
  net:net.textContent
 });
 localStorage.setItem(KEY,JSON.stringify(d));
 render();
}

function render(){
 hist.innerHTML="";
 (JSON.parse(localStorage.getItem(KEY)||"")).slice().reverse().forEach(e=>{
  hist.innerHTML+=`<tr>
   <td>${e.date}</td><td>${e.ville}</td><td>${e.type}</td>
   <td>${e.nb}</td><td>${e.net}</td>
   <td><button class="small danger" onclick="del('${e.id}')">X</button></td>
  </tr>`;
 });
}

function del(id){
 localStorage.setItem(KEY,JSON.stringify(JSON.parse(localStorage.getItem(KEY)).filter(e=>e.id!==id)));
 render();
}
function clearAll(){if(confirm("Tout effacer ?")){localStorage.removeItem(KEY);render();}}
function reset(){brut.value=0;calc();}
calc();render();
</script>

</body>
</html>